{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>TrailLend Dashboard</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
<link rel="icon" type="image/svg" href="{% static 'favicon.svg' %}">


<style> 

  /* ================================
   GLOBAL RESET / BASE
================================ */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html, body {
  height: 100%;
  overflow: hidden;
  font-family: "Poppins", Arial, sans-serif;
  background: #f4f6f9;
}

/* ================================
   HEADER
================================ */
.header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 60px;
  padding: 12px 20px;
  background: #fff;
  border-bottom: 1px solid #ddd;
  display: flex;
  align-items: center;
  justify-content: space-between;
  z-index: 1000;
}

.logo {
  display: flex;
  align-items: center;
  font-size: 1rem;
  font-weight: 600;
}

.logo img.avatar {
  width: 45px;
  height: 35px;
  margin-right: 10px;
}

.header-title {
  flex: 1;
  text-align: center;
  color: #444;
  font-weight: 600;
}

.notif-bell {
  font-size: 1.4rem;
  cursor: pointer;
}

.notif-badge {
  position: absolute !important;
  top: -8px;
  right: -8px;
  background: #e11d48 !important;
  color: #fff !important;
  padding: 3px 7px !important;
  border-radius: 999px !important;
  min-width: 18px;
  height: 18px;
  font-size: 11px !important;
  font-weight: 700 !important;
  text-align: center;
  display: none;
  pointer-events: none;
}

/* ================================
   SIDEBAR
================================ */
.sidebar {
  position: fixed;
  top: 60px;
  left: 0;
  bottom: 0;
  width: 240px;
  background: #fff;
  border-right: 1px solid #ddd;
  padding: 20px 12px;
  overflow-y: auto;
  z-index: 999;
}

.sidebar a {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 14px;
  border-radius: 8px;
  font-weight: 500;
  margin-bottom: 6px;
  text-decoration: none;
  color: #444;
  transition: 0.2s;
}

.sidebar a:hover {
  background: #e9f3ff;
}

.sidebar a.active {
  background: #90c8d8;
  color: white;
}

.sidebar a i {
  font-size: 1.1rem;
}

/* ================================
   RIGHT PENDING PANEL
================================ */
.pending-panel {
  position: fixed;
  top: 60px;
  right: 0;
  bottom: 0;
  width: 300px;
  background: #ffffff;
  border-left: 1px solid #d9dfe7;
  padding: 18px;
  overflow-y: auto;
  z-index: 900;
}

.pending-panel h3 {
  margin-bottom: 14px;
  font-weight: 700;
  font-size: 16px;
  color: #1e293b;
}

/* Pending List */
#pendingList {
  list-style: none;
  padding: 0;
  margin: 0;
}

.pending-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #ffffffaa;
  border-radius: 12px;
  padding: 14px;
  margin-bottom: 12px;
  border-left: 5px solid #4FC3F7;
  cursor: pointer;
  transition: 0.15s ease-in-out;
}

.pending-item:hover {
  background: #eef7ff;
  transform: translateY(-2px);
}

.meta-user {
  font-size: 13px;
  margin-bottom: 3px;
}

.user-name {
  font-size: 15px;
  font-weight: 700;
  color: #0D47A1;
}

.dot {
  margin: 0 3px;
}

.status {
  font-size: 13px;
  font-weight: 600;
}

.status.pending {
  color: #FFA500 !important;
}

.item-name {
  font-size: 14px;
  font-weight: 600;
  color: #222;
}

.more-items {
  color: #555;
  font-size: 12px;
}

/* Priority Badges */
.priority-badge {
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 700;
  color: white;
}

.priority-badge.high {
  background: #FFA500;
}

.priority-badge.low {
  background: #4FC3F7;
}

/* Empty state */
.pending-empty {
  text-align: center;
  font-size: 13px;
  color: #777;
  font-style: italic;
}

/* ================================
   MAIN CONTENT
================================ */
.content {
  position: fixed;
  top: 60px;
  left: 240px;
  right: 300px;
  bottom: 0;
  padding: 20px;
  overflow-y: auto;
  background: #f9fafc;
}

body:not(.dashboard) .content {
  right: 0 !important;
}

/* ================================
   RESERVATION MODAL
================================ */
.modal-card {
  background: #fff;
  border-radius: 16px;
  width: 900px;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  animation: popIn 0.25s ease-out;
}

@keyframes popIn {
  from { transform: scale(0.92); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

.modal-header {
  background: #4FC3F7;
  padding: 18px 22px;
  color: white;
  font-weight: 700;
  font-size: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-close {
  background: none;
  border: none;
  font-size: 26px;
  color: white;
  cursor: pointer;
}

.modal-body {
  padding: 24px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 26px;
  overflow-y: auto;
}

/* Section Titles */
.section h3 {
  font-weight: 700;
  font-size: 16px;
  color: #0D47A1;
  margin-bottom: 8px;
}

/* Info Boxes */
.info-box {
  background: #f0f4f8;
  border-radius: 10px;
  padding: 14px;
  min-height: 80px;
  border: 1px solid #d8e1eb;
  font-size: 14px;
  color: #333;
  line-height: 1.5;
}

/* Priority Badge */
.badge {
  padding: 8px 16px;
  font-size: 15px;
  border-radius: 30px;
  font-weight: 700;
  width: fit-content;
  margin-bottom: 10px;
}

.badge.high {
  background: #ffebee;
  color: #c62828;
  border: 1px solid #ffcdd2;
}

.badge.low {
  background: #e3f9ee;
  color: #2e7d32;
  border: 1px solid #b2dfdb;
}

/* Borrower Info */
.section p {
  margin: 4px 0;
  font-size: 14px;
}

.section p strong {
  color: #111;
  font-weight: 700;
}

/* Requested Items */
.item-list {
  list-style: none;
  padding: 0;
}

.item-list li {
  background: #f8fafc;
  padding: 8px 10px;
  border-radius: 8px;
  margin-bottom: 6px;
  border: 1px solid #e2e8f0;
  font-size: 14px;
  font-weight: 500;
}

/* Image */
.doc-img {
  width: 100%;
  max-height: 250px;
  object-fit: contain;
  border: 1px solid #ddd;
  border-radius: 10px;
  background: white;
}

/* Footer Buttons */
.modal-footer {
  display: flex;
  justify-content: space-between;
  margin-top: 20px;
}

.btn {
  padding: 12px 18px;
  border-radius: 10px;
  border: none;
  font-weight: 700;
  cursor: pointer;
  font-size: 14px;
}

.btn-approve {
  background: #4CAF50;
  color: white;
}

.btn-approve:hover {
  background: #449d48;
}

.btn-declined {
  background: #E53935;
  color: white;
}

.btn-declined:hover {
  background: #c62828;
}

/* ================================
   DECLINE MODAL
================================ */
.decline-box {
  width: 400px;
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.2);
}

.decline-box h3 {
  font-size: 18px;
  font-weight: 700;
  color: #0D47A1;
  margin-bottom: 12px;
}

.decline-textarea {
  width: 100%;
  height: 120px;
  border-radius: 6px;
  padding: 10px;
  border: 1px solid #ccc;
}

.decline-actions {
  display: flex;
  justify-content: space-between;
  margin-top: 14px;
}

.decline-cancel,
.decline-submit {
  padding: 10px 14px;
  border-radius: 8px;
  font-weight: 600;
  border: none;
  cursor: pointer;
}

.decline-cancel {
  background: #e0e0e0;
}

.decline-submit {
  background: #E53935;
  color: white;
}


</style>
</head>


<body class="{% if request.resolver_match.url_name == 'dashboard' %}dashboard{% endif %}">



<!-- HEADER -->
<header class="header">
    <div class="logo">
        <img src="{% static 'TRAILLEND-ICON.png' %}" class="avatar"/>
        <span>TrailLend</span>
    </div>

    <div class="header-title">Barangay Kauswagan - General Service Office</div>

    <div class="notif-bell" style="position:relative;">
      <i class="fa-solid fa-bell"></i>
      <span id="notifCount" class="notif-badge">0</span>
    </div>

</header>

<!-- SIDEBAR -->
<aside class="sidebar">
    <p class="menu-label">MENU</p>

    <a href="{% url 'dashboard' %}" class="{% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}">
        <i class="fa-solid fa-gauge"></i> Dashboard
    </a>

    <a href="{% url 'inventory' %}" class="{% if request.resolver_match.url_name == 'inventory' %}active{% endif %}">
        <i class="fas fa-box"></i> Inventory
    </a>

    <a href="{% url 'verification' %}" class="{% if request.resolver_match.url_name == 'verification' %}active{% endif %}">
        <i class="fa-solid fa-check-circle"></i> Verification
    </a>

    <a href="{% url 'transaction_log' %}" class="{% if request.resolver_match.url_name == 'transaction_log' %}active{% endif %}">
        <i class="fa-solid fa-clock-rotate-left"></i> Transaction Log
    </a>

    <a href="{% url 'damage_loss_report_list' %}" class="{% if request.resolver_match.url_name == 'damage_loss_report_list' %}active{% endif %}">
        <i class="fa-solid fa-file-lines"></i> Damage Report
    </a>

    <a href="{% url 'statistics' %}" class="{% if request.resolver_match.url_name == 'statistics' %}active{% endif %}">
        <i class="fa-solid fa-chart-bar"></i> Statistics
    </a>

    <a href="{% url 'list_of_users' %}" class="{% if request.resolver_match.url_name == 'list_of_users' %}active{% endif %}">
        <i class="fa-solid fa-users"></i> List of Users
    </a>

    <a href="{% url 'change_password' %}" class="{% if request.resolver_match.url_name == 'change_password' %}active{% endif %}">
        <i class="fa-solid fa-key"></i> Change Pass
    </a>

    <a href="{% url 'logout' %}">
        <i class="fa-solid fa-right-from-bracket"></i> Log out
    </a>
</aside>

<!-- RIGHT PANEL -->
{% if request.resolver_match.url_name == 'dashboard' %}
<aside class="pending-panel">
    <h3>Pending Requests</h3>
    <ul id="pendingList"><li>Loading...</li></ul>
</aside>
{% endif %}

<!-- MAIN CONTENT -->
<main class="content">
    {% block content %}{% endblock %}
</main>

<!-- RESERVATION MODAL -->
<div id="reservationModal"
     style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.55);
            justify-content:center; align-items:center; z-index:5000;">

    <div class="modal-card">
        <div class="modal-header">
            <h2>Reservation Details</h2>
            <button id="closeModal" class="modal-close">&times;</button>
        </div>

        <div class="modal-body">

            <div>
                <div class="section">
                    <h3>Reason for Borrowing</h3>
                    <div class="info-box">
                        <p id="modalReasonLeft"></p>
                    </div>
                </div>
            </div>

            <div>
                <div style="margin-bottom: 10px;">
                    <span id="modalPriorityBadge" class="badge"></span>
                </div>

                <div class="section">
                    <h3>Borrower Information</h3>
                    <p><strong>Name:</strong> <span id="modalBorrower"></span></p>
                    <p><strong>Contact:</strong> <span id="modalContact"></span></p>
                </div>

                <div class="section">
                    <h3>Requested Items</h3>
                    <ul id="modalItemList" class="item-list"></ul>
                </div>

                <div class="section">
                    <h3>Schedule</h3>
                    <p><strong>Borrow Date:</strong> <span id="modalBorrowDate"></span></p>
                    <p><strong>Return Date:</strong> <span id="modalReturnDate"></span></p>
                </div>

                <div class="section">
                    <h3>Valid ID</h3>
                    <img id="modalID" class="doc-img" alt="ID">
                </div>

                <div class="modal-footer">
                    <button id="approveBtn" class="btn btn-approve">Approve</button>
                    <button id="declinedBtn" class="btn btn-declined">Decline</button>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- DECLINE MODAL -->
<div id="declinedModal"
     style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.55);
            justify-content:center; align-items:center; z-index:6000;">

    <div class="decline-box">
        <h3>Reason for Decline</h3>
        <textarea id="declinedReason" class="decline-textarea"></textarea>

        <div class="decline-actions">
            <button id="cancelDecline" class="decline-cancel">Cancel</button>
            <button id="submitDecline" class="decline-submit">Submit</button>
        </div>
    </div>

</div>

<script src="{% static 'js/script.js' %}"></script>

</body>
</html>
